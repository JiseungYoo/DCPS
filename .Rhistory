df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score,
join_by(StudentID %>% select(-School_Year_Start), diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>% select(-School_Year_Start),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
enrollment_student.school.year %>%
filter(Grade %in% 6:8)
enrollment_student.school.year %>%
filter(Grade %in% 6:8, ShoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days==max(Membership_Days)
enrollment_student.school.year %>%
enrollment_student.school.year %>%
filter(Grade %in% 6:8, ShoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days==max(Membership_Days))
enrollment_student.school.year
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), ShoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days==max(Membership_Days)),
join_by()),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(!School %in% c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days==max(Membership_Days))
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days==max(Membership_Days) %>% select(StudentID, School_ID)),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(!School %in% c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days==max(Membership_Days) %>% select(StudentID, School_ID))
enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days) %>%
select(StudentID, School_ID))
enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID)
enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID))
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(!School %in% c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(!School %in% c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID)
raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID))
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(!School %in% c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type))
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(!School %in% c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(School %in% stari_schools[-c(1071, 454, 435)]) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(School %in% stari_schools, !School %in% -c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(School %in% stari_schools, !School %in% c(1071, 454, 435)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(School %in% stari_schools, !School %in% c(1071, 454, 435, 405)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(School %in% stari_schools, !School %in% c(1071, 454, 435, 405, 416)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(School %in% stari_schools, !School %in% c(1071, 454, 435, 405, 416, 404)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
df %>%
filter(!School %in% c(1071, 454, 435)) %>%
group_by(StudentID) %>%
reframe(Grade = max(Grade),
School = first(School),
diagnostic_ri = max(diagnostic_ri),
s_sri_ss_f = max(s_sri_ss_f),
stari_naive = max(stari_naive),
percent_naive= max(percent_naive)) %>%
mutate(student_type = ifelse(percent_naive > 0.5, "stari", "non-stari")) %>%
filter(!is.na(s_sri_ss_f)) %>%
right_join(raw_test_score %>%
select(-School_Year_Start) %>%
inner_join(enrollment_student.school.year %>%
filter(Grade %in% c('6', '7', '8'), SchoolYearStart == 2022) %>%
group_by(StudentID) %>%
filter(Membership_Days == max(Membership_Days)) %>%
select(StudentID, School_ID) %>%
rename(School = School_ID),
join_by(StudentID)),
join_by(StudentID, diagnostic_ri, s_sri_ss_f, Grade, School)) %>%
mutate(student_type = ifelse(is.na(student_type), "no-intervention", student_type)) %>%
filter(School %in% stari_schools, !School %in% c( 454, 435, 405, 416, 404)) %>%
# count(stari_naive, student_type) %>%
ggplot(aes(x = s_sri_ss_f, fill = student_type)) +
geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
facet_grid(School ~ Grade) +
theme_minimal() +
labs(x = "Diagnostic RI", y = "Count", fill = "Student Type") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
geom_segment(x = 800, y = 0, yend = 12, xend = 800)
